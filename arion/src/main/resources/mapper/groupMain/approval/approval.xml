<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.arion.app.group.main.approval.mapper.ApprovalMapper">
	<insert id="insertApproval" parameterType="ApprovalVO">
		INSERT INTO approval(appr_no
							, doc_no
							, employee_no
							, sequence
							, company_code
							, appr_status
		) VALUES (appr_seq.NEXTVAL
				 , #{docNo}
				 , #{employeeNo}
				 , #{sequence}
				 , #{companyCode}
				 , '결재대기'
		)
	</insert>
	
	<select id="apprInfo" resultType="ApprovalVO">
		SELECT a.appr_status
			 , a.appr_reason
			 , a.sign_date
			 , a.sequence
			 , a.company_code
			 , a.doc_no
			 , e.employee_no
			 , e.employee_name
			 , e.rank_name
			 , e.department_name
		FROM approval a JOIN employees e
						ON a.employee_no = e.employee_no
		WHERE 1=1 
		AND a.doc_no = #{docNo}
		AND a.company_code = #{companyCode}
		ORDER BY sequence DESC;		
	</select>
</mapper>